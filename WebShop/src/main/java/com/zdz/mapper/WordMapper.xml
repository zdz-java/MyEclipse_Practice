<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zdz.mapper.MerMapper">
	<resultMap id="leavewordResultMap" type="Leaveword">
		<id property="id" column="id" />
		<result property="title" column="title" />
		<result property="content" column="content" />
		<result property="leaveDate" column="leaveDate" />
		<result property="answerContent" column="answerContent" />
		<result property="answerDate" column="answerDate" />
		<association property="member" resultMap="memberResultMap" />
		<association property="admin" resultMap="adminResultMap" />
	</resultMap>
	<resultMap id="memberResultMap" type="Member">
		<id property="id" column="id" />
		<result property="loginName" column="loginName" />
		<result property="loginPwd" column="loginPwd" />
		<result property="memberName" column="memberName" />
		<result property="phone" column="phone" />
		<result property="address" column="address" />
		<result property="zip" column="zip" />
		<result property="regDate" column="regDate" />
		<result property="lastDate" column="lastDate" />
		<result property="loginTimes" column="loginTimes" />
		<result property="email" column="email" />
		<association property="memberlevel" resultMap="memberlevelResultMap" />
	</resultMap>
	<resultMap type="Memberlevel" id="memberlevelResultMap">
		<id property="id" column="id" />
		<result property="levelName" column="levelName" />
		<result property="favourable" column="favourable" />
	</resultMap>
	<resultMap id="adminResultMap" type="Admin">
		<id property="id" column="id" />
		<result property="adminType" column="adminType" />
		<result property="adminName" column="adminName" />
		<result property="loginName" column="loginName" />
		<result property="loginPwd" column="loginPwd" />
	</resultMap>
	<update id="updateMer">
		update merchandise set
		merName=#{merName},price=#{price},sprice=#{sprice},merModel=#{merModel},picture=#{picture},merDesc=#{merDesc},manufacturer=#{manufacturer},leaveFactoryDate=#{leaveFactoryDate},special=#{special},category=#{category.id}
		where id =
		#{id}
	</update>
	<insert id="addMer" useGeneratedKeys="true" keyProperty="id">
		insert
		into merchandise
		values(null,#{category.id},#{merName},#{price},#{sprice},#{merModel},#{picture},#{merDesc},#{manufacturer},#{leaveFactoryDate},#{special})
	</insert>
	<insert id="addCategory" useGeneratedKeys="true" keyProperty="id">
		insert into category
		values(null,#{cateName},#{cateDesc})
	</insert>
	<delete id="delMer">
		delete from merchandise where id=#{id}
	</delete>
	<delete id="delCategory">
		delete from category where id=#{id}
	</delete>
	<select id="loadCategory" resultMap="categoryResultMap">
		select *
		from category where
		id =
		#{id}
	</select>
	<select id="loadMer" resultMap="merchandiseResultMap">
		select *
		from merchandise where
		id
		=
		#{id}
	</select>
	<update id="updateCategory">
		update category set
		cateName=#{cateName},cateDesc=#{cateDesc}
		where id =
		#{id}
	</update>

	<select id="browseCategory" resultMap="categoryResultMap">
		select
		* from
		category
	</select>
	<select id="browseMer" parameterType="java.lang.String"
		resultMap="merchandiseResultMap">
		select
		* from merchandise where merName like #{hql}
	</select>
	<select id="countRecord" parameterType="String" resultType="int">
		select
		count(*) from merchandise where merName like
		#{hql,jdbcType=VARCHAR}
	</select>
</mapper>